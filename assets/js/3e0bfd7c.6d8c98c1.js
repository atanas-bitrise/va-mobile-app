"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[4765],{61949:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var a=r(58168),n=(r(96540),r(15680));r(41873);const i={},o="Models",l={unversionedId:"Engineering/BackEnd/Architecture/ModelsAndSerializers",id:"Engineering/BackEnd/Architecture/ModelsAndSerializers",title:"Models",description:"Unlike a typical Rails app, most of the models in the mobile module do not use ActiveRecord. Most of our models are populated from upstream data sources, so there's no need to store the data in a local database, which makes them a bad fit for ActiveRecord. As a result, most vets-api models inherit from Dry::Types to validate attribute data types.",source:"@site/docs/Engineering/BackEnd/Architecture/ModelsAndSerializers.md",sourceDirName:"Engineering/BackEnd/Architecture",slug:"/Engineering/BackEnd/Architecture/ModelsAndSerializers",permalink:"/va-mobile-app/docs/Engineering/BackEnd/Architecture/ModelsAndSerializers",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"JSON API",permalink:"/va-mobile-app/docs/Engineering/BackEnd/Architecture/JSONAPI"},next:{title:"OpenAPI Documentation",permalink:"/va-mobile-app/docs/Engineering/BackEnd/Architecture/OpenAPIDocumentation"}},s={},d=[{value:"Serializers",id:"serializers",level:2},{value:"Best Practice",id:"best-practice",level:2}],c={toc:d},p="wrapper";function u(e){let{components:t,...r}=e;return(0,n.yg)(p,(0,a.A)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.yg)("h1",{id:"models"},"Models"),(0,n.yg)("p",null,"Unlike a typical Rails app, most of the models in the mobile module do not use ActiveRecord. Most of our models are populated from upstream data sources, so there's no need to store the data in a local database, which makes them a bad fit for ActiveRecord. As a result, most vets-api models inherit from ",(0,n.yg)("inlineCode",{parentName:"p"},"Dry::Struct")," instead of ",(0,n.yg)("inlineCode",{parentName:"p"},"ActiveRecord::Base")," to represent data. Dry structs use ",(0,n.yg)("a",{parentName:"p",href:"https://dry-rb.org/gems/dry-types"},(0,n.yg)("inlineCode",{parentName:"a"},"Dry::Types"))," to validate attribute data types."),(0,n.yg)("h2",{id:"serializers"},"Serializers"),(0,n.yg)("p",null,"Mobile serializers use ",(0,n.yg)("inlineCode",{parentName:"p"},"JSONAPI::Serializer")," and they do two things:"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"ensure that our responses are formatted as valid ",(0,n.yg)("a",{parentName:"li",href:"/va-mobile-app/docs/Engineering/BackEnd/Architecture/JSONAPI"},"JSONAPI")),(0,n.yg)("li",{parentName:"ul"},"determine which attributes from the model are included in the response")),(0,n.yg)("h2",{id:"best-practice"},"Best Practice"),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"all data should be converted to models in order to use type validation"),(0,n.yg)("li",{parentName:"ul"},"all nested attributes should be fully detailed within the data model in order to whitelist and validate all attributes that will be serialized. In other words, if a model has an attribute that is a hash or an array of hashes, all attributes in the hash should also be validated with ",(0,n.yg)("inlineCode",{parentName:"li"},"Dry::Types"),". For example, a hash could look like:")),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"},"  attribute :debt_history do\n    attribute :date, Types::Date\n    attribute :letter_code, Types::String\n    attribute :description, Types::String\n  end\n")),(0,n.yg)("p",null,"an array of hashes could look like:"),(0,n.yg)("pre",null,(0,n.yg)("code",{parentName:"pre"},"  attribute :debt_history, Types::Array do\n    attribute :date, Types::Date\n    attribute :letter_code, Types::String\n    attribute :description, Types::String\n  end\n")),(0,n.yg)("ul",null,(0,n.yg)("li",{parentName:"ul"},"all data should be serialized to ensure JSONAPI compliance")))}u.isMDXComponent=!0},15680:(e,t,r)=>{r.d(t,{xA:()=>c,yg:()=>y});var a=r(96540);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),d=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},c=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=d(r),m=n,y=p["".concat(s,".").concat(m)]||p[m]||u[m]||i;return r?a.createElement(y,o(o({ref:t},c),{},{components:r})):a.createElement(y,o({ref:t},c))}));function y(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:n,o[1]=l;for(var d=2;d<i;d++)o[d]=r[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},41873:(e,t,r)=>{r(96540)}}]);